import Joi, { ObjectSchema } from 'joi';
import { Injectable } from '@nestjs/common';
import { JoiObjectId } from '@core/validations/exetensions';
import { <%= namePascal %>SearchArgs } from '../dto';
import { Base<%= namePascal %>Pipe } from './base-<%= nameCamel %>.pipe';

@Injectable()
export class Search<%= namePascal %>Pipe extends Base<%= namePascal %>Pipe<<%= namePascal %>SearchArgs> {
  rules(): ObjectSchema {
    const params = Joi.object({
      q: Joi.string().allow('').optional(),
      sort: Joi.object().optional(),
      and: Joi.object().optional(),
      ids: Joi.array().items(JoiObjectId).optional(),
      page: Joi.number().min(1).optional(),
      perPage: Joi.number().min(1).optional(),
    });

    return Joi.object({ params }).optional();
  }
}
